<h1>Apuntes y trucos de Javascript</h1>

<h2>Cabecera</h2>

Incluir en la cabecera

<pre><code>
&lt;script type="text/javascript" src="archivo.js"&gt;&lt;/script&gt;
</code></pre>




<h2>Funciones útiles</h2>

<p>Ejecutar tras la carga del DOM</p>

<pre><code class="javascript">
document.addEventListener('DOMContentLoaded', function(){ 
	// Tu código aquí
}, false);
</code></pre>

Detener el hilo de ejecución por un tiempo
<pre><code class="javascript">
function sleep(ms) {
	return new Promise(resolve => setTimeout(resolve, ms));
}

async function myFunción(){
	await sleep(100);
}
</code></pre>

<h2>SVG</h2>
<p>La <a href="js/Svg.js">librería Svg</a> completa</p>

Crear el objeto
<p>Contenedor del lienzo en el <em>html</em> será</p>

<pre><code class="html">
	&lt;svg id="canvas1" width="800px" height="500px"&gt;
</code></pre>

<pre><code class="javascript">
// Ejemplo para crear el lienzo en <em>javascript</em>
async function main(){
	s = new Svg("canvas1", 800, 500);
	s.drawAxis();
	s.drawGrid();
}
</code></pre>

Dibujar objetos en el lienzo
<pre><code class="javascript">	
// Prototipos de métodos de la clase Svg
addCircle(circleId, cx, cy, r, fillColor, strokeWidth = 0, strokeColor = null);
addLine(lineId, x0, y0, x1, y1, color, width);
</code></pre>

En este ejemplo se crea un punto llamado <em>p1</em> en las 
coordenadas <em>x, y</em> de radio 4 y de color rojo
<pre><code class="javascript">
s.addCircle("p1", x, y, 4, "red");
</code></pre>

<p>Mover dos puntos asincrónicamente. Uno se moverá en círculos y el otro en línea recta</p>
<pre><code class="javascript">
var o1, o2;
function sleep(ms) {
	return new Promise(resolve => setTimeout(resolve, ms));
}

async function mover1(){
	for(var i=0; i<200; i+=0.1){
		var p = 50*Math.sin(i/10.0);
		o1.setAttribute("cx", s.px(50*Math.cos(i/10.0)));
		o1.setAttribute("cy", s.py(50*Math.sin(i/10.)));
		await sleep(1);
		console.log("1");
	}
}

async function mover2(){
	for(var i=0; i<100; i++){
		console.log("2");
		o2.setAttribute("cx", s.px(-i));
		await sleep(100);
		console.log("2");
	}
}

document.addEventListener('DOMContentLoaded', function(){ 
	s = new Svg("canvas1", 800, 500);
	s.drawAxis();
	s.drawGrid();
	o1  = s.addCircle("c1", 0, 0, 5, "red");
	o2  = s.addCircle("c2", 0, 0, 5, "blue");

	mover1();
	mover2();

}, false);
</code></pre>
